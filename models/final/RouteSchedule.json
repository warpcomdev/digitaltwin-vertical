{
  "RouteSchedule": {
    "namespace": "dtwin",
    "exampleId": "C1",
    "description": "Programación de ruta. Describe el número de paradas de una ruta\ndada una estacionalidad, tipo de día y hora.",
    "model": {
      "TimeInstant": {
        "description": "Fecha / Hora del cálculo de vista identidad o simulación",
        "ngsiType": "DateTime",
        "dbType": "timestamp with time zone NOT NULL",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": "2018-12-10T20:40:23",
        "range": "-"
      },
      "sourceRef": {
        "description": "ID de entidad original.\nReemplaza al entityId, ya que esta entidad es *singleton*\ny su ID en base de datos se ve sobrescrito por una\ncomposición de los campos únicos.\n\nEn el caso de las entidades tipo `RouteSchedule`, la columna entityid\nde la base de datos contendrá una concatenación de los siguientes\natributos, separados por `_`:\n\n`sceneRef`, `sourceRef`, `trend`, `dayType`, `hour`",
        "ngsiType": "TextUnrestricted",
        "dbType": "text",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": "NA_Entity1_Verano_Sabado_21",
        "range": "-"
      },
      "sceneRef": {
        "description": "ID del escenario de simulación.\nIdentifica la simulación realizada. El valor \"NA\"\nindica que se trata de una vista identidad.",
        "ngsiType": "TextUnrestricted",
        "dbType": "text",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": "example text",
        "range": "-"
      },
      "trend": {
        "description": "Estacionalidad o tendencia para la que se ha calculado el escenario",
        "ngsiType": "TextUnrestricted",
        "dbType": "text",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": "Verano",
        "range": "Verano, Fallas, Otros"
      },
      "dayType": {
        "description": "Tipo de día al que corresponde la medida",
        "ngsiType": "TextUnrestricted",
        "dbType": "text",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": "L-J",
        "range": "L-J, Viernes, Sábado, Domingo"
      },
      "name": {
        "description": "Nombre descriptivo de la entidad",
        "ngsiType": "TextUnrestricted",
        "dbType": "text",
        "extra": "-",
        "unit": "-",
        "flows": [
          "lastdata"
        ],
        "example": "example text",
        "range": "-"
      },
      "hour": {
        "description": "Hora del día a la que corresponde la medida",
        "ngsiType": "Number",
        "dbType": "int",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "range": "0-23",
        "example": 15
      },
      "zoneList": {
        "description": "Lista de identificadores de la zona o distrito a la que pertenece la entidad",
        "ngsiType": "Json",
        "dbType": "json",
        "extra": "-",
        "unit": "-",
        "example": [
          "Distrito 1",
          "Distrito 4"
        ],
        "flows": [
          "historic",
          "lastdata"
        ],
        "range": "-"
      },
      "forwardTrips": {
        "description": "Número de trayectos de ida",
        "ngsiType": "Number",
        "dbType": "double precision",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": 5.0,
        "range": "-"
      },
      "returnTrips": {
        "description": "Número de trayectos de vuelta",
        "ngsiType": "Number",
        "dbType": "double precision",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": 5.0,
        "range": "-"
      },
      "forwardStops": {
        "description": "Número de paradas en el trayecto de ida",
        "ngsiType": "Number",
        "dbType": "int",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": 5,
        "range": "-"
      },
      "location": {
        "description": "Ubicación de la entidad",
        "ngsiType": "geo:json",
        "dbType": "geometry(MultiLineString)",
        "extra": "-",
        "unit": "-",
        "flows": [
          "lastdata"
        ],
        "example": {
          "type": "geo:json",
          "value": {
            "type": "Line",
            "coordinates": [
              [
                [
                  3.5,
                  24.6
                ],
                [
                  33,
                  44
                ]
              ]
            ]
          }
        },
        "range": "-"
      },
      "returnStops": {
        "description": "Número de paradas en el trayecto de vuelta",
        "ngsiType": "Number",
        "dbType": "int",
        "extra": "-",
        "unit": "-",
        "flows": [
          "historic",
          "lastdata"
        ],
        "example": 5,
        "range": "-"
      }
    },
    "flows": {
      "historic": {
        "class": "FLOW_HISTORIC",
        "endpoint": "HISTORIC",
        "replaceId": [
          "sceneRef",
          "sourceRef",
          "trend",
          "dayType",
          "hour"
        ],
        "condition": {
          "attrs": [
            "TimeInstant",
            "sceneRef",
            "sourceRef",
            "trend",
            "dayType",
            "hour"
          ]
        }
      },
      "lastdata": {
        "class": "FLOW_LASTDATA",
        "endpoint": "LASTDATA",
        "condition": {
          "attrs": [
            "TimeInstant",
            "sceneRef",
            "sourceRef",
            "trend",
            "dayType",
            "hour"
          ],
          "alterationTypes": [
            "entityUpdate",
            "entityCreate"
          ]
        },
        "replaceId": [
          "sceneRef",
          "sourceRef",
          "trend",
          "dayType",
          "hour"
        ]
      },
      "custom_sql": {
        "class": "FLOW_RAW",
        "sql": {
          "sources": {
            "custom_sql": {
              "documentation": "Conjunto de vistas utilitarias para la presentación de\ndatos de escenarios identidad y simulaciones.",
              "path": "./sql",
              "files": [
                "custom_RouteSchedule.sql"
              ],
              "weight": 10,
              "relations": [
                "dtwin_routeschedule_vector"
              ]
            }
          }
        }
      },
      "join": {
        "class": "FLOW_JOIN_VIEW",
        "leftModel": {
          "name": "routeschedule",
          "entityNamespace": "dtwin",
          "attrs": [
            "entityid",
            "entityType",
            "fiwareservicepath",
            "recvtime",
            "timeinstant",
            "sourceref",
            "sceneref",
            "trend",
            "daytype",
            "hour",
            "zonelist",
            "forwardtrips",
            "returntrips",
            "forwardstops",
            "returnstops"
          ],
          "attrJoinOn": [
            "entityid"
          ]
        },
        "rightModel": [
          {
            "name": "routeschedule_lastdata",
            "entityNamespace": "dtwin",
            "attrs": [
              "name",
              "location"
            ],
            "attrJoinOn": [
              "entityid"
            ]
          }
        ]
      }
    }
  }
}